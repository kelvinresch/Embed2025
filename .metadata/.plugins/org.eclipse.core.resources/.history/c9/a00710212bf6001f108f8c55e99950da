#include <MKL46Z4.h>
#include "ECE3140Lab2.h"
#include "led.h"

void main(void){
	/*
	 * Initialize the microcontroller and LEDs
	 */
	set15MHz();
	led_init();
	/*
	 * Enable the clock to go to the PIT by setting the
	 * 23rd bit of SIM_SCGC6 high
	 */
	SIM->SCGC6 |= SIM_SCGC6_PIT_MASK;

	/*
	 * Set load value of PIT zero
	 */
	PIT->CHANNEL[0].LDVAL = 0x30000;

	/*
	 * Enable the PIT module by setting the 2nd bit of the PIT's
	 * MCR register low
	 */
	PIT->MCR &= !PIT_MCR_MDIS_MASK;

	/*
	 * Enable the timer on the PIT module
	 */
	PIT->CHANNEL[0].TCTRL |= PIT_TCTRL_TEN_MASK;

	while(1) {
		// If the PIT reaches 0
		if (PIT->CHANNEL[0].TFLG & 0x1) {
			// Toggle the LED
			red_toggle();
			// Reset the PIT
			PIT->CHANNEL[0].LDVAL = 0x30000;
		}
	}
}







